---
title: 提供优惠
description: Decision Management is a collection of services and UI programs that enables marketers to create and deliver end-user personalized offer experiences across channels and applications using business logic and decision rules.
feature: Offers
topic: Integrations
role: Data Engineer
level: Experienced
exl-id: 692d0aae-6fa1-40b8-a35f-9845d78317a3
source-git-commit: 882b99d9b49e1ae6d0f97872a74dc5a8a4639050
workflow-type: tm+mt
source-wordcount: '937'
ht-degree: 3%

---

# 使用决策API提供优惠 {#deliver-offers-using-decisions-api}

借助决策管理，您可以使用业务逻辑和决策规则跨渠道和应用程序创建和提供最终用户个性化选件体验。 选件是营销消息，其中可能包含与其关联的规则，以指定有资格查看选件的用户。

您可以通过向 [!DNL Decisions] API。

本教程需要对API（特别是与决策管理有关的API）有一定的了解。 有关更多信息，请参阅 [决策管理API开发人员指南](../getting-started.md). 此外，本教程还要求您具有唯一的版面ID和决策ID值。 如果您尚未获取这些值，请参阅 [创建版面](../offers-api/placements/create.md) 和 [创建决策](../activities-api/activities/create.md).

➡️  [在视频中发现此功能](#video)

## Accept and Content-Type headers {#accept-and-content-type-headers}

The following table shows the valid values which comprise the *Content-Type* and *Accept* fields in the request header:

| 标题名称 | 值 |
| ----------- | ----- |
| Accept | `application/vnd.adobe.xdm+json; schema="https://ns.adobe.com/experience/offer-management/decision-response;version=1.0"` |
| Content-Type | `application/vnd.adobe.xdm+json; schema="https://ns.adobe.com/experience/offer-management/decision-request;version=1.0"` |

**API格式**

```https
POST /{ENDPOINT_PATH}/{CONTAINER_ID}/decisions
```

| 参数 | 描述 | 示例 |
| --------- | ----------- | ------- |
| `{ENDPOINT_PATH}` | 存储库API的端点路径。 | `https://platform.adobe.io/data/core/ode/` |
| `{CONTAINER_ID}` | 决策所在的容器。 | `e0bd8463-0913-4ca1-bd84-6309134ca1f6` |

**请求**

```shell
curl -X POST \
  'https://platform.adobe.io/data/core/ode/e0bd8463-0913-4ca1-bd84-6309134ca1f6/decisions' \
  -H 'Accept: application/vnd.adobe.xdm+json; schema="https://ns.adobe.com/experience/offer-management/decision-response;version=1.0"' \
  -H 'Content-Type: application/vnd.adobe.xdm+json; schema="https://ns.adobe.com/experience/offer-management/decision-request;version=1.0'
  -H 'Authorization: Bearer {ACCESS_TOKEN}' \
  -H 'x-api-key: {API_KEY}' \
  -H 'x-gw-ims-org-id: {IMS_ORG}' \
  -H 'x-sandbox-name: {SANDBOX_NAME}'
  -d '{
        "xdm:propositionRequests": [
            {
              "xdm:placementId": "xcore:offer-placement:ffed0456",
              "xdm:activityId": "xcore:offer-activity:ffed0123",
              "xdm:itemCount": 2
            },
            {
              "xdm:placementId": "xcore:offer-placement:ffed0012",
              "xdm:activityId": "xcore:offer-activity:fffc0789"
            }
        ],
        "xdm:profiles": [
            {
              "xdm:identityMap": {
                "SWCUSTID": [
                {
                    "xdm:id": "123@abc.com"
                }
                ]
            },
            "xdm:decisionRequestId": "0AA00002-0000-1337-c0de-c0fefec0fefe"
            }
        ],
        "xdm:allowDuplicatePropositions": {
            "xdm:acrossActivities": true,
            "xdm:acrossPlacements": true
        },
        "xdm:mergePolicy": {
            "xdm:id": "5f3ed32f-eaf1-456c-b0f0-7b338c4cb18a"
        },
        "xdm:responseFormat": {
            "xdm:includeContent": true,
            "xdm:includeMetadata": {
            "xdm:activity": [
                "name"
            ],
            "xdm:option": [
                "name"
            ],
            "xdm:placement": [
                "name"
            ]
            }
        }
      }'
```

| 属性 | 描述 | 示例 |
| -------- | ----------- | ------- |
| `xdm:propositionRequests` | 此对象包含放置和决策标识符。 |
| `xdm:propositionRequests.xdm:placementId` | 唯一版面标识符。 | `"xdm:placementId": "xcore:offer-placement:ffed0456"` |
| `xdm:propositionRequests.xdm:activityId` | 唯一决策标识符。 | `"xdm:activityId": "xcore:offer-activity:ffed0123"` |
| `xdm:itemCount` | 要返回的选件数。 最大数为30。 | `"xdm:itemCount": 2` |
| `xdm:profiles` | 此对象包含有关请求决策的用户档案的信息。 对于API请求，此配置文件将包含一个配置文件。 |
| `xdm:profiles.xdm:identityMap` | This object holds a set of end user identities based on the namespace integration code of the identity. 标识映射可以携带每个命名空间的多个标识。 有关命名空间的更多信息，请参阅[此页面](../../../start/get-started-identity.md)。 | `Email: [{"xdm:id": "123@abc.com"}]` |
| `xdm:profiles.xdm:decisionRequestId` | The ID generated by the client that can be used to uniquely identify a profile decision request. 此ID在响应中回复，不影响决策的结果。 | `"xdm:decisionRequestId": "0AA00002-0000-1337-c0de-c0fefec0fefe"` |
| `xdm:allowDuplicatePropositions` | 此对象是重复数据消除规则的控制结构。 它由一系列标记组成，这些标记指示是否可以在特定维度中提出相同的选项。 设置为true的标记表示允许重复项，且不应在标志指示的类别中删除。 设置为false的标记表示决策引擎不应在整个维度中提出相同的建议，而是为其中一个子决策选择下一个最佳选项。 |
| `xdm:allowDuplicatePropositions.xdm:acrossActivities` | 如果设置为true，则可能会为多个决策分配相同的选项。 | `"xdm:acrossActivities": true` |
| `xdm:allowDuplicatePropositions.xdm:acrossPlacements` | 如果设置为true，则可能会为多个版面分配相同的选项。 | `"xdm:acrossPlacements": true` |
| `xdm:mergePolicy.xdm:id` | 标识用于管理配置文件访问服务返回数据的合并策略。 如果未在请求中指定某个用户档案，则决策管理将不会传递任何用户档案访问服务，否则将传递调用方提供的ID。 | `"xdm:id": "5f3ed32f-eaf1-456c-b0f0-7b338c4cb18a"` |
| `xdm:responseFormat` | 一组用于设置响应内容格式的标记。 |
| `xdm:responseFormat.xdm:includeContent` | A boolean value that, if set to `true`, includes content to the response. | `"xdm:includeContent": true` |
| `xdm:responseFormat.xdm:includeMetadata` | 用于指定返回哪些附加元数据的对象。 如果未包含此属性，则 `xdm:id` 和 `repo:etag` 默认情况下，将返回。 | `name` |
| `xdm:responseFormat.xdm:activity` | 此标记标识为 `xdm:activity`. | `name` |
| `xdm:responseFormat.xdm:option` | 此标记标识为 `xdm:option`. | `name`、`characteristics` |
| `xdm:responseFormat.xdm:placement` | 此标记标识为 `xdm:placement`. | `name`、`channel`、`componentType` |

**响应**

A successful response returns information on your proposition, including its unique `xdm:propositionId`.

```json
{
  "xdm:propositionId": "5d0ffb5e-dfc6-4280-99b6-0bf3131cb8b8",
  "xdm:propositions": [
    {
      "xdm:activity": {
        "xdm:id": "xcore:activity:ffed0123",
        "repo:etag": 4
      },
      "xdm:placement": {
        "xdm:id": "xcore:placement:ffed0456",
        "repo:etag": 1
      },
      "xdm:options": [
        {
          "xdm:id": "xcore:personalized-option:ccc0111",
          "repo:etag": 3,
          "@type": "https://ns.adobe.com/experience/decisioning/content-component-html-template",
          "xdm:content": "<html>some html</html>"
        },
        {
          "xdm:id": "xcore:personalized-option:ccc0222",
          "repo:etag": 5,
          "@type": "https://ns.adobe.com/experience/decisioning/content-component-html-template",
          "xdm:content": "<html>hello, world</html>",
          "xdm:score": 45.65
        }
      ]
    },
    {
      "xdm:activity": {
        "xdm:id": "xcore:activity:ffed0123",
        "repo:etag": 4
      },
      "xdm:placement": {
        "xdm:id": "xcore:placement:ffed0789",
        "repo:etag": 2
      },
      "xdm:fallback": {
        "xdm:id": "xcore:fallback:ccc0222",
        "repo:etag": 5,
        "@type": "https://ns.adobe.com/experience/decisioning/content-component-imagelink",
        "dc:format": "image/png",
        "xdm:deliveryURL": "https://cdn.adobe.com/content/1445323-1134331.png",
        "xdm:content": "https://www.adobe.com/index2.html"
      }
    }
  ],
  "ode:createDate": 1566497582038
}
```

| 属性 | 描述 | 示例 |
| -------- | ----------- | ------- |
| `xdm:propositionId` | 与XDM DecisionEvent关联的命题实体的唯一标识符。 | `"xdm:propositionId": "5d0ffb5e-dfc6-4280-99b6-0bf3131cb8b8"` |
| `xdm:propositions` | 此对象包含单个决策建议。 可返回多个选项供决策使用。 如果找不到选项，则返回决策的备用选件。 单个决策建议始终包括 `options` 属性或 `fallback` 属性。 若存在， `options` 属性不能为空。 |
| `xdm:propositions.xdm:activity` | 此对象包含决策的唯一标识符。 | `"xdm:id": "xcore:activity:ffed0123"` |
| `xdm:propositions.xdm:placement` | 此对象包含选件放置的唯一标识符。 | `"xdm:id": "xcore:placement:ffed0456"` |
| `xdm:propositions.xdm:options` | 此对象包含单个选项，包括其唯一标识符。 如果存在，则此对象不能为空。 | `xdm:id": "xcore:personalized-option:ccc0111` |
| `xdm:propositions.xdm:options.@type` | 定义组件的类型。 `@type` 充当客户的处理合同。 组合体验后，编辑器将查找具有特定类型的组件。 | `https://ns.adobe.com/experience/offer-management/content-component-imagelink` |
| `xdm:propositions.xdm:content` | 响应内容的格式。 | 响应内容可以是： `text`, `html block`或 `image link` |
| `xdm:score` | 作为与选项或决策关联的排名函数的结果计算的选项的分数。 如果在排名期间涉及排名函数来确定选件的得分，则API将返回此字段。 | `"xdm:score": 45.65` |
| `xdm:propositions.xdm:fallback` | 此对象包含单个备用选件，包括其唯一标识符。 | `"xdm:id": "xcore:fallback:ccc0222"` |
| `xdm:propositions.xdm:fallback.dc:format` | 资源的物理或数字显示。 通常，格式应包括资源的媒体类型。 该格式可用于确定显示或操作资源所需的软件、硬件或其它设备。 It is recommended to select a value from a controlled vocabulary, for example, the list of [Internet Media Types](http://www.iana.org/assignments/media-types/) defining computer media formats. | `"dc:format": "image/png"` 或 `"image/jpeg"` |
| `xdm:propositions.xdm:fallback.xdm:deliveryURL` | 用于从内容交付网络或服务端点读取资产的可选URL。 此URL用于从用户代理公开访问资产。 | `https://d37yhxrr0p3l3l.cloudfront.net/0fd0f090-a148-11ea-89e3-f1f2ad52f7e8/urn:aaid:sc:US:a68c86a6-9295-4940-a083-11916b665500/0/40d78a12-f8b6-3f07-8e67-7cb8ae2cc7ec` |
| `ode:createDate` | 创建决策响应消息的时间。 This is represented as epoch time. | `"ode:createDate": 1566497582038` |

## 教程视频 {#video}

以下视频旨在支持您对决策管理组件的了解。

>[!NOTE]
>
>此视频适用于基于Adobe Experience Platform构建的Offer decisioning应用程序服务。 但是，它为在Journey Optimizer上下文中使用选件提供了通用指南。

>[!VIDEO](https://video.tv.adobe.com/v/329919/?quality=12)

## 后续步骤 {#next-steps}

按照本API指南，您已使用 [!DNL Decisions] API。 有关更多信息，请参阅 [决策管理概述](../../../offers/get-started/starting-offer-decisioning.md).
